Function CPFNJ(n As Variant) As String
    Dim str As String
    
    ' Converte o valor para texto
    On Error GoTo ErrorHandler
    str = CStr(n)
    
    ' Remove quaisquer caracteres não numéricos
    str = Replace(str, " ", "")
    str = Replace(str, "-", "")
    str = Replace(str, ".", "")
    str = Replace(str, "/", "")
    
    ' Adiciona zeros à esquerda conforme o número de dígitos
    Select Case Len(str)
        Case Is <= 11
            ' Adiciona zeros à esquerda para CPF
            str = String(11 - Len(str), "0") & str
        Case Is <= 14
            ' Adiciona zeros à esquerda para CNPJ
            str = String(14 - Len(str), "0") & str
        Case Else
            CPFNJ = "Inválido" ' Retorna um texto indicando que o documento é inválido
            Exit Function
    End Select
    
    ' Formata o texto de acordo com o número de dígitos
    Select Case Len(str)
        Case 11
            ' Formata como CPF
            CPFNJ = Format$(str, "000\.000\.000\-00")
        Case 14
            ' Formata como CNPJ
            CPFNJ = Format$(str, "00\.000\.000\/0000\-00")
        Case Else
            CPFNJ = "Inválido" ' Retorna um texto indicando que o documento é inválido
    End Select
    
    Exit Function

ErrorHandler:
    CPFNJ = "Erro: " & Err.Description
End Function
